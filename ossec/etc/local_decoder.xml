<decoder name="avahi">
  <program_name>avahi-daemon</program_name>
</decoder>

<decoder name="avahi-dnsconfd">
  <program_name>avahi-dnsconfd</program_name>
</decoder>

<decoder name="bsd_kernel">
  <program_name>/bsd</program_name>
</decoder>

<decoder name="bsd_arp">
  <parent>bsd_kernel</parent>
  <prematch offset="after_parent">^arp </prematch>
  <!--<regex offset="after_prematch"> overwritten for (\S+) by (\S+) on \S+</regex>-->
  <regex offset="after_prematch"> for (\S+) by (\S+) on \S+</regex>
  <order>dstip, extra_data</order>
</decoder>

<!-- This does not work quite the way I expect yet:
<decoder name="bsd_hd">
  <parent>bsd_kernel</parent>
  <use_own_name>true</use_own_name>
  <prematch offset="after_parent">^wd|^sd</prematch>
  <regex>^(wd\d)|(sd\d)</regex>
  <order>extra_data</order>
</decoder>
-->

<decoder name="python">
  <program_name>^python</program_name>
</decoder>


<decoder name="dropbear">
  <program_name>dropbear</program_name>
</decoder>

<!--Mar 24 15:25:51 buffalo1 dropbear[4092]: bad password attempt for 'root' from 192.168.17.9:5543-->
<decoder name="dropbear-from">
  <parent>dropbear</parent>
  <regex>for '(\S+)' from (\S+):\d+$</regex>
  <order>dstuser,srcip</order>
</decoder>

<decoder name="smtpd">
  <program_name>smtpd</program_name>
</decoder>

<!--Oct 26 22:30:12 ix smtpd[6726]: client 192.168.17.9 read error: Connection reset by peer-->
<decoder name="smtpd-client">
  <parent>smtpd</parent>
  <prematch offset="after_parent">^client</prematch>
  <regex>client (\S+) </regex>
  <order>srcip</order>
</decoder>

<!--Nov 13 17:30:34 ix smtpd[29377]: (none): from=<@>, relay=power.example.com [192.168.17.249], stat=LocalError (501 EHLO requires domain address)-->
<decoder name="smtpd-relay">
  <parent>smtpd</parent>
  <prematch>relay=</prematch>
  <regex>relay=\S+ [(\S+)], </regex>
  <order>srcip</order>
</decoder>

<!--May 28 09:15:43 ix groupdel[25984]: group deleted: name=_dbus-->
<decoder name="groupdel">
  <program_name>groupdel</program_name>
  <regex>^group deleted: name=(\S+)$</regex>
  <order>extra_data</order>
</decoder>


<!--Apr 10 13:22:52 tiny isakmpd[6988]: dropped message from 192.168.1.233 port 500 due to notification type INVALID_COOKIE-->
<decoder name="isakmpd">
  <program_name>isakmpd</program_name>
</decoder>

<decoder name="isakmpd-from">
  <parent>isakmpd</parent>
  <prematch>message from </prematch>
  <regex>from (\S+) port (\d+)</regex>
  <order>srcip,srcport</order>
</decoder>

<!--Nov  4 18:15:59 alphen-vpn-gw isakmpd[28891]: transport_send_messages: giving up on exchange ISAKMP-peer-node-ldn, no response from peer 192.168.1.1:500-->
<decoder name="isakmpd-peer">
  <parent>isakmpd</parent>
  <prematch>from peer</prematch>
  <regex>from peer (\S+):(\d+)$</regex>
  <order>srcip,srcport</order>
</decoder>


<!--Apr 11 20:01:02 ix mountd[11618]: Refused mount RPC from host 192.168.17.10 port 45659-->
<decoder name="mountd">
  <program_name>^mountd</program_name>
</decoder>

<decoder name="mountd-host">
  <parent>mountd</parent>
  <prematch>from host </prematch>
  <regex offset="after_prematch">(\S+) port \d+$</regex>
  <order>srcip</order>
</decoder>

<decoder name="nmbd">
  <program_name>^nmbd</program_name>
</decoder>


<decoder name="launchproxy">
  <program_name>launchproxy</program_name>
</decoder>

<decoder name="bro-ids">
  <program_name>^bro</program_name>
</decoder>

<!--Aug 25 08:52:10 junction bro: no=PortScanSummary na=NOTICE_ALARM_ALWAYS es=bro sa=192.168.17.8 num=988 msg=192.168.17.8\\\\ scanned\\\\ a\\\\ total\\\\ of\\\\ 988\\\\ ports tag=@ef-24ad-af-->
<decoder name="bro-portscan">
  <parent>bro-ids</parent>
  <prematch>no=PortscanSummary</prematch>
  <regex>sa=(\S+) num=(\d+) msg=</regex> 
  <order>srcip,extra_data</order>
</decoder>

<!--Aug 26 12:34:27 junction bro: no=PortScan na=NOTICE_ALARM_ALWAYS es=bro sa=192.168.17.8 p=17/tcp num=250 msg=192.168.17.8\\ has\\ scanned\\ 250\\ ports\\ of\\ 192.168.17.17 tag=@11-68e9-5-->
<decoder name="bro-portscan2">
  <parent>bro-ids</parent>
  <prematch>no=PortScan </prematch>
  <regex>sa=(\S+) p=(\d+)/(\S+) num=(\d+)</regex>
  <order>srcip,srcport,protocol,extra_data</order>
</decoder>

<!--XXX This is for some personal testing and will be removed.-->
<!--Aug 25 13:20:35 ix bro: WTF domain: sacxtra.com other: 208.53.158.84-->
<decoder name="bro-wtf">
  <parent>bro-ids</parent>
  <prematch offset="after_parent">^WTF domain</prematch>
  <regex>WTF domain: (\S+) other: (\S+)$</regex>
  <order>extra_data,srcip</order>
</decoder>

<!--This is for a personal bro-ids script that looks at the responses for dns lookups and compares the resulting IP to a list of known bad IPs-->
<!--XXX Format is subject to change!-->
<!--Aug 25 13:28:48 junction bro: no=DNS_Bad_Response na=NOTICE_ALARM_ALWAYS es=bro sa=192.168.1.1 sp=42166/udp da=192.168.1.2 dp=53/udp p=53/udp msg=
BadResponse\\ for\\ example.com\\ (192.168.2.1) tag=@ce-a7a-1-->
<!--Aug 28 22:21:29 junction bro: no=DNS_Bad_Response na=NOTICE_ALARM_ALWAYS es=bro sa=192.168.17.17 sp=16254/udp da=208.67.220.220 dp=53/udp p=53/udp msg=BadResponse\\\\ for\\\\ torrent-finder.com\\\\ (208.101.51.57) tag=@11-68e9-3e-->
<decoder name="bro-baddns">
  <parent>bro-ids</parent>
  <prematch>no=DNS_Bad_Response</prematch>
  <regex>es=bro sa=(\S+) sp=(\d+)/(\S+) da=(\S+) dp=(\d+)/\S+ p=\d+/\S+ msg=BadResponse\S+ for\S+ (\S+)\\\S+ </regex>
  <order>srcip,srcport,protocol,dstip,dstport,url</order>
</decoder>

<decoder name="bro-typical">
  <parent>bro-ids</parent>
  <prematch>na=NOTICE</prematch>
  <regex>sa=(\S+) sp=(\d+)/(\S+) da=(\S+) dp=(\d+)/\S+</regex>
  <order>srcip,srcport,protocol,dstip,dstport</order>
</decoder>


<!--Jun 26 08:19:25 servername sh: nss_ldap: reconnecting to LDAP server (sleeping 32 seconds)...-->
<decoder name="nss-ldap">
  <program_name></program_name>
  <prematch>nss_ldap</prematch>
</decoder>

<!--Aug 16 10:58:12 client nscd: nss_ldap: failed to bind to LDAP server ldap://ldap.example.com: Can't contact LDAP server-->
<decoder name="ldap-server">
  <parent>nss-ldap</parent>
  <prematch> server </prematch>
  <regex offset="after_prematch">ldap://(\S+):</regex>
  <order>system_name</order>
</decoder>

<!--2010/08/02 14:17:39 ossec-dbd(1230): ERROR: Invalid element in the configuration: 'list'.-->
<decoder name="ossec-dbd">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-dbd</prematch>
</decoder>

<!--'2010/08/30 11:38:12 ossec-remoted: ERROR: Unable to create merged file: '/etc/shared/merged.mg'.-->
<decoder name="ossec-remoted">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-remoted</prematch>
</decoder>

<!--2010/08/30 11:45:16 ossec-rootcheck(1251): ERROR: Invalid rk configuration name: '^M'.-->
<decoder name="ossec-rootcheck">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-rootcheck</prematch>
</decoder>

<!--2010/08/31 10:05:08 ossec-reportd: ERROR: Invalid related entry 'Rule'.-->
<decoder name="ossec-reportd">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-reportd</prematch>
</decoder>

<!--2010/08/31 14:41:29 ossec-config(1226): ERROR: Error reading XML file 'etc/ossec.conf': XMLERR: File 'etc/ossec.conf' not found. (line 0).-->
<decoder name="ossec-config">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-config</prematch>
</decoder>

<!--2010/09/01 04:41:11 ossec-logcollector: Bad formated nmap grepable file (port).-->
<decoder name="ossec-logcollector">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-logcollector</prematch>
</decoder>

<!--2010/09/01 15:09:42 ossec-syscheckd(1124): ERROR: Unable to rename file: '/etc/malloc.conf'.-->
<decoder name="ossec-syscheckd">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-syscheckd</prematch>
</decoder>

<!--2010/09/01 13:52:55 ossec-testrule(1202): ERROR: Configuration error at '/etc/local_decoder.xml'. Exiting.-->
<decoder name="ossec-testrule">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-testrule</prematch>
</decoder>

<!--2010/09/01 14:15:49 ossec-analysisd(2107): ERROR: Decoder configuration error: 'dennis-test'.2010/09/01 14:15:49 ossec-analysisd(2107): ERROR: Decoder configuration error: 'dennis-test'.-->
<decoder name="ossec-analysisd">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ ossec-analysisd</prematch>
</decoder>

<!--2010/09/13 19:48:32 decode-xml: Wrong field 'hostname' in the order of decoder 'attack data'-->
<decoder name="decode-xml">
  <prematch>\d+/\d+/\d+ \d+:\d+:\d+ decode-xml</prematch>
</decoder>







