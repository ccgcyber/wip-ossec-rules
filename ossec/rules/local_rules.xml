<!-- @(#) $Id: local_rules.xml,v 1.7 2010/03/04 20:12:33 dcid Exp $
  -  Example of local rules for OSSEC.
  -
  -  Copyright (C) 2009 Trend Micro Inc.
  -  All rights reserved.
  -
  -  This program is a free software; you can redistribute it
  -  and/or modify it under the terms of the GNU General Public
  -  License (version 2) as published by the FSF - Free Software
  -  Foundation.
  -
  -  License details: http://www.ossec.net/en/licensing.html
  -->


<!-- Modify it at your will. -->

<group name="local,syslog,">

  <!-- Note that rule id 5711 is defined at the ssh_rules file
    -  as a ssh failed login. This is just an example
    -  since ip 1.1.1.1 shouldn't be used anywhere.
    -  Level 0 means ignore.
    -->
  <rule id="100001" level="0">
    <if_sid>5711</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>Example of rule that will ignore sshd </description>
    <description>failed logins from IP 1.1.1.1.</description>
  </rule>
  
  
  <!-- This example will ignore ssh failed logins for the user name XYZABC.
    -->
  <!--  
  <rule id="100020" level="0">
    <if_sid>5711</if_sid>
    <user>XYZABC</user>
    <description>Example of rule that will ignore sshd </description>
    <description>failed logins for user XYZABC.</description>
  </rule>
  -->
  
  
  <!-- Specify here a list of rules to ignore. -->
  <!--
  <rule id="100030" level="0">
    <if_sid>12345, 23456, xyz, abc</if_sid>
    <description>List of rules to be ignored.</description>
  </rule>
  -->

  <!--Oct 13 12:03:19 ix arpwatch: pcap open re0: /dev/bpf0: Permission denied-->
  <rule id="200001" level="1">
    <if_sid>7200</if_sid>
    <match>/dev/bpf0: Permission denied</match>
    <description>arpwatch probably run with wrong permissions</description>
  </rule>

  <rule id="210000" level="0" noalert="1">
    <decoded_as>avahi</decoded_as>
    <description>Grouping for avahi alerts</description>
  </rule>

  <rule id="210001" level="0" noalert="1">
    <decoded_as>avahi-dnsconfd</decoded_as>
    <description>Grouping for avahi-dnsconfd</description>
  </rule>

  <!--Jul  8 00:47:19 gorilla avahi-daemon[32088]: dbus_bus_get_private(): Failed to connect to socket /var/run/dbus/system_bus_socket: No such file or di
rectory-->
  <rule id="210010" level="1">
    <if_sid>210000</if_sid>
    <match>Failed to connect to socket</match>
    <description>XXX Could not connect to socket</description>
  </rule>

  <!--Jul  8 00:47:19 gorilla avahi-daemon[32088]: WARNING: Failed to contact D-Bus daemon.-->
  <rule id="210011" level="1">
    <if_sid>210000</if_sid>
    <match>Failed to contact D-Bus daemon</match>
    <description>Cannot connect to D-Bus daemon</description>
  </rule>

  <!--Jul  8 00:59:06 gorilla avahi-daemon[22180]: IP_DROP_MEMBERSHIP failed: Can't assign requested address-->
  <rule id="210012" level="1">
    <if_sid>210000</if_sid>
    <match>Can't assign requested address</match>
    <description>Cannot assign requested address</description>
  </rule>

  <!--Sep  6 01:56:16 gorilla avahi-dnsconfd[30635]: Failed to parse browsing line: <28>Sep  6 01:56:16 avahi-daemon[13441]: Invalid query packet.ansfer o
n gorilla"(/etc/avahi/services/sftp-ssh.service) successfully established.\M^A:\^L\^R\^\\^A-->
  <rule id="210013" level="1">
    <if_sid>210001</if_sid>
    <match>Invalid query packet.ansfer</match>
    <description>XXX</description>
  </rule>

  <rule id="220000" level="0" noalert="1">
    <decoded_as>bsd_kernel</decoded_as>
    <description>Grouping of bsd_kernel alerts</description>
  </rule>

  <!--Mar  3 10:30:10 ix /bsd: ichiic0: abort failed, status 0x40<INUSE>-->
  <rule id="220001" level="1">
    <if_sid>220000</if_sid>
    <match>ichiic0: abort failed, status 0x40</match>
    <description>XXX</description>
  </rule>

  <!--Apr  3 18:35:14 power /bsd: cd0(atapiscsi0:0:0): Check Condition (error 0x70) on opcode 0x0-->
  <rule id="220002" level="1">
    <if_sid>220000</if_sid>
    <match>Check Condition (error 0x70) on opcode 0x0</match>
    <description>XXX</description>
  </rule>

  <!--Apr 20 01:27:21 gorilla /bsd: umass0: BBB bulk-in clear stall failed, TIMEOUT-->
  <rule id="220003" level="1">
    <if_sid>220000</if_sid>
    <match>BBB bulk-in clear stall failed</match>
    <description>XXX</description>
  </rule>

  <!--'Jun  8 23:40:41 gorilla /bsd: arp info overwritten for 192.168.17.111 by 00:16:01:4b:45:a6 on sk0-->
  <rule id="220004" level="1">
    <if_sid>220000</if_sid>
    <match>arp info overwritten for</match>
    <description>arp info has been overwritten for a host</description>
  </rule>

  <!--Jun  8 21:46:18 gorilla /bsd: WARNING: / was not properly unmounted-->
  <rule id="220005" level="5">
    <if_sid>220000</if_sid>
    <match>was not properly unmounted</match>
    <description>A filesystem was not properly unmounted, likely system crash</description>
  </rule>

  <!--May 26 23:30:57 gorilla /bsd: UKC> quit-->
  <rule id="220006" level="1">
    <if_sid>220000</if_sid>
    <match>UKC> quit</match>
    <description>UKC was used, possibly modifying a kernel at boot time.</description>
  </rule>

  <!--Oct 15 20:06:43 mobile /bsd: run0: Michael MIC failure-->
  <rule id="220007" level="1">
    <if_sid>220000</if_sid>
    <match>Michael MIC failure</match>
    <description>XXX Michael MIC failure (wifi)</description>
  </rule>

  <!--Oct 17 07:39:56 power /bsd: wd0: soft error (corrected)-->
  <rule id="220008" level="2">
    <if_sid>220000</if_sid>
    <!--<if_sid>1002</if_sid>-->
    <match>soft error (corrected)</match>
    <description>A soft error has been corrected on a hard drive, </description>
    <description>this is a possible early sign of failure.</description>
  </rule>

  <!--Jan 12 19:40:27 x60 /bsd: acpithinkpad0: unknown event 0x6022-->
  <rule id="220009" level="1">
    <if_sid>220000</if_sid>
    <regex>acpithinkpad\d:</regex>
    <match>unknown event 0x6022</match>
    <description>XXX acpithinkpad event</description>
  </rule>

  <!--Jan 12 19:40:45 x60 /bsd: acpitz1: Critical temperature, shutting down-->
  <rule id="220010" level="5">
    <if_sid>220000</if_sid>
    <match>Critical temperature, shutting down</match>
    <description>System shutdown due to temperature</description>
  </rule>

  <!--Jan 18 09:22:45 bart /bsd: acpitz0: _AL0[0] _PR0 failed-->
  <rule id="220011" level="1">
    <if_sid>220000</if_sid>
    <match>_AL0[0] _PR0 failed</match>
    <description>XXX</description>
  </rule>

  <!--Feb 26 11:18:59 ix /bsd: ehci_freex: xfer=0xffff8000003ef800 not busy, 0x4f4e5155-->
  <rule id="220012" level="1">
    <if_sid>220000</if_sid>
    <match>ehci_freex: xfer=0xffff8000003ef800 not busy, 0x4f4e5155</match>
    <description>XXX usb?</description>
  </rule>

  <!--Feb 28 23:23:21 ix /bsd: ichiic0: abort failed, status 0x0-->
  <rule id="220013" level="1">
    <if_sid>220000</if_sid>
    <match>ichiic0: abort failed, status 0x0</match>
    <description>XXX</description>
  </rule>

  <rule id="230000" level="0" noalert="1">
    <decoded_as>python</decoded_as>
    <description>Grouping for python rules</description>
  </rule>

  <rule id="230001" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-scan</match>
    <description>Grouping for hp-scan rules</description>
  </rule>

  <rule id="230002" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-probe</match>
    <description>Grouping for hp-probe rules</description>
  </rule>

  <rule id="230003" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-setup</match>
    <description>Grouping for hp-setup rules</description>
  </rule>

  <rule id="230004" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-info</match>
    <description>Grouping for hp-info rules</description>
  </rule>

  <rule id="230005" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-makeuri</match>
    <description>Grouping for hp-makeuri rules</description>
  </rule>

  <rule id="230006" level="0" noalert="1">
    <if_sid>230000</if_sid>
    <match>^hp-check</match>
    <description>Grouping for hp-check rules</description>
  </rule>

  <!--Jul  8 00:45:36 gorilla python2.5: hp-scan[552]: error: No device-->
  <rule id="230020" level="1">
    <if_sid>230001</if_sid>
    <regex>^hp-scan[\d+]: error: No device</regex>
    <description>hp-scan could not find a printer</description>
  </rule>

  <!--Jul  8 00:46:53 gorilla python2.5: hp-probe[24546]: error: Unable to setup multicast socket for SLP: (22, 'Invalid argument')-->
  <rule id="230021" level="1">
    <if_sid>230002</if_sid>
    <regex>^hp-probe[\S+]: </regex>
    <match>error: Unable to setup multicast socket for SLP</match>
    <description>XXX</description>
  </rule>

  <!--Jul  8 01:14:31 gorilla python2.5: hp-setup[21147]: error: hp-setup requires GUI support (try running with --qt3). Also, try using interactive (-i)
mode.-->
  <rule id="230022" level="1">
    <if_sid>230003</if_sid>
    <match>requires GUI support</match>
    <description>hp-setup requires a GUI</description>
  </rule>

  <!--Jul  8 01:17:38 gorilla python2.5: hp-setup[21681]: error: No devices found on bus: net-->
  <rule id="230023" level="1">
    <if_sid>230003</if_sid>
    <match>error: No devices found on bus:</match>
    <description>hp-setup could not find a printer</description>
  </rule>

  <!--Jul  8 01:32:22 gorilla python2.5: hp-info[25919]: error:  No devices found.-->
  <rule id="230024" level="1">
    <if_sid>230004</if_sid>
    <match>error:  No devices found.</match>
    <description>hp-info cannot find a printer</description>
  </rule>

  <!--Jul  8 02:10:43 gorilla python2.5: hp-makeuri[8442]: error: You must specify one SERIAL NO., IP, USB ID or DEVNODE parameter.-->
  <rule id="230025" level="1">
    <if_sid>230005</if_sid>
    <match>error: You must specify one</match>
    <description>A proper ID was not specified for hp-makeuri</description>
  </rule>

  <!--Jul  8 02:12:10 gorilla python2.5: hp-check[27994]: error: Not found. SANE backend 'hpaio' NOT properly setup (needs to be added to /etc/sane.d/dll.
conf).-->
  <rule id="230026" level="1">
    <if_sid>230006</if_sid>
    <match>error: Not found. SANE backend 'hpaio' NOT properly setup</match>
    <description>hpaio has not been setup.</description>
  </rule>

  <!--Jul  8 02:12:13 gorilla python2.5: hp-check[27994]: error: 4 errors and/or warnings.-->
  <rule id="230027" level="1">
    <if_sid>230006</if_sid>
    <match>errors and/or warnings</match>
    <description>errors and/or warnings were found in the configuration</description>
  </rule>

  <!--Jul  8 02:29:30 gorilla python2.5: hp-makeuri[13147]: error: Device not found-->
  <rule id="230028" level="1">
    <if_sid>230005</if_sid>
    <match>error: Device not found</match>
    <description>hp-makeuri could not find the printer device</description>
  </rule>

  <rule id="240000" level="0" noalert="1">
    <program_name>^hp$</program_name>
    <description>Grouping for hp rules</description>
  </rule>

  <rule id="240001" level="0" noalert="1">
    <program_name>^hp-mkuri$</program_name>
    <description>Grouping for hp-mkuri rules</description>
  </rule>



  <!--'Aug 23 20:03:57 power hp[2463]: prnt/backend/hp.c 593: ERROR: 1009 media-empty-error; will retry in 30 seconds...-->
  <rule id="240010" level="1">
    <if_sid>240000</if_sid>
    <match>1009 media-empty-error</match>
    <description>Printer is out of paper</description>
  </rule>

  <!--Jul  8 02:11:42 gorilla hp-mkuri: io/hpmud/hp-mkuri.c 223: error no hp_model environment variable set-->
  <rule id="240011" level="0">
    <if_sid>240001</if_sid>
    <match>error no hp_model environment variable set</match>
    <description>Please set the hp_model environment variable</description>
  </rule>


  <rule id="250000" level="0" noalert="1">
    <program_name>cvsyncd</program_name>
    <description>Grouping for cvsyncd rules</description>
  </rule>

  <!--Oct 21 02:09:46 ix cvsyncd[19692]: /var/run/cvsyncd.pid: Permission denied-->
  <rule id="250010" level="1">
    <if_sid>250000</if_sid>
    <match>cvsyncd.pid: Permission denied</match>
    <description>cvsyncd cannot write pid file with current permissions</description>
  </rule>

  <!--Oct 26 22:31:17 ix cvsyncd[3699]: Socket Error: recv: 2 residue 2-->
  <rule id="250011" level="1">
    <if_sid>250000</if_sid>
    <match>Socket Error: recv: 2 residue 2</match>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:13:23 ix cvsyncd[551]: configuration: failed to reload-->
  <rule id="250012" level="1">
    <if_sid>250000</if_sid>
    <match>configuration: failed to reload</match>
    <description>Error in configuration</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: [192.168.17.33] (9b5c193f) DirCmp: RCS Error-->
  <rule id="250013" level="1">
    <if_sid>250000</if_sid>
    <match>DirCmp: RCS Error</match>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: Receiver Error: recv-->
  <rule id="250014" level="1">
    <if_sid>250000</if_sid>
    <match>Receiver Error: recv</match>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: [192.168.17.33] (9b5c193f) FileCmp: RCS Error-->
  <rule id="250015" level="1">
    <if_sid>250000</if_sid>
    <match>FileCmp: RCS Error</match>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: Mux(RECV) Error: not running: 0-->
  <rule id="250016" level="1">
    <if_sid>250000</if_sid>
    <match>Mux(RECV) Error: not running: 0</match>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: [192.168.17.33] (9b5c193f) FileCmp(RCS): /data/cvs/sysconf/buffalo1/buffalo1.nvram,v: UPDATE Error-->
  <rule id="250017" level="1">
    <if_sid>250000</if_sid>
    <regex>FileCmp(RCS): \.+ : UPDATE Error</regex>
    <description>XXX</description>
  </rule>

  <!--Nov 24 03:17:11 ix cvsyncd[15862]: Mux(SEND) Error: not running: 1-->
  <rule id="250018" level="1">
    <if_sid>250000</if_sid>
    <match>Mux(SEND) Error: not running: 1</match>
    <description>XXX</description>
  </rule>





</group> <!-- SYSLOG,LOCAL -->


<!-- EOF -->
