  <!-- Copyright 2010 Dan Parriott (ddpbsd@gmail.com)
  -  This program is a free software; you can redistribute it
  -  and/or modify it under the terms of the GNU General Public
  -  License (version 2) as published by the FSF - Free Software
  -  Foundation.
  -
  -  License details: http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
  -->



<!-- Modify it at your will. -->

<group name="local,syslog,">

  <!--Jun 22 12:01:13 junction sshd[11283]: Received disconnect from 212.14.228.46: 11: Bye Bye-->
  <rule id="370010" level="1">
    <if_sid>5700</if_sid>
    <match>Received disconnect from</match>
    <description>System disconnected from sshd.</description>
  </rule>

  <!--Apr 14 19:28:21 gorilla sshd[31274]: Connection closed by 192.168.1.33-->
  <rule id="370011" level="1">
    <if_sid>5700</if_sid>
    <match>Connection closed</match>
    <description>ssh connection closed.</description>
  </rule>

  <!--Jun 11 06:32:17 gorilla sshd[28293]: error: buffer_get_bignum2_ret: negative numbers not supported-->
  <rule id="370012" level="0">
    <if_sid>5700</if_sid>
    <match>error: buffer_get_bignum2_ret: negative numbers not supported</match>
    <info>This maybe a bad key in authorized_keys.</info>
    <description>SSHD key error.</description>
  </rule>

  <!--Jun 11 06:32:17 gorilla sshd[28293]: fatal: buffer_get_bignum2: buffer error-->
  <rule id="370013" level="0">
    <if_sid>5700</if_sid>
    <match>fatal: buffer_get_bignum2: buffer error</match>
    <info>This error may relate to ssh key handling.</info>
    <description>SSHD key error.</description>
  </rule>

  <!--Jun 19 20:56:00 tiny sshd[11605]: fatal: Write failed: Host is down-->
  <rule id="370014" level="1">
    <if_sid>5700</if_sid>
    <match>fatal: Write failed: Host is down</match>
    <description>Host ungracefully disconnected.</description>
  </rule>

  <!--Oct  8 11:18:26 172.16.51.132 sshd[7618]: error: PAM: Module is unknown for ddp from 172.16.51.1-->
  <rule id="370015" level="5">
    <if_sid>5700</if_sid>
    <match>error: PAM: Module is unknown for</match>
    <description>Unknown PAM module, PAM misconfiguration</description>
  </rule>

  <!--Oct  8 08:48:33 y sshd[6856]: error: Bind to port 22 on 0.0.0.0 failed: Address already in use.-->
  <rule id="370016" level="0">
    <if_sid>5700</if_sid>
    <match>failed: Address already in use.</match>
    <description>Attempt to start sshd when something already bound to the port.</description>
  </rule>

  <!--Oct  8 08:58:37 y sshd[6956]: fatal: PAM: pam_setcred(): Authentication service cannot retrieve user credentials-->
  <rule id="370017" level="4">
    <if_sid>5700</if_sid>
    <match>Authentication service cannot retrieve user credentials</match>
    <info>May be related to PAM module errors.</info>
    <description>Authentication services were not able to retrieve user credentials.</description>
  </rule>

  <!--Oct  8 10:07:27 y sshd[7644]: debug1: attempt 2 failures 2-->
  <rule id="370018" level="0">
    <if_sid>5700</if_sid>
    <match>debug1: attempt</match>
    <description>Debug message.</description>
  </rule>

  <!--Jan 26 11:57:26 ix sshd[14879]: error: connect to ix.example.com port 7777 failed: Connection refused-->
  <rule id="370019" level="4">
    <if_sid>5700</if_sid>
    <regex>error: connect to \S+ port \d+ failed: Connection refused</regex>
    <description>sshd is not accepting connections.</description>
  </rule>

  <!--Jun  9 00:00:01 ix sshd[9815]: scanned from 127.0.0.1 with SSH-1.99-AKASSH_Version_Mapper1.  Don't panic.-->
  <rule id="370020" level="1">
    <if_sid>5700</if_sid>
    <match>AKASSH_Version_Mapper1.</match>
    <description>SSH Scanning.</description>
    <group>recon,</group>
  </rule>

  <!--Aug 10 08:38:40 junction sshd[20013]: error: connect_to 192.168.179 port 8080: failed.-->
  <rule id="370021" level="2">
    <if_sid>5700</if_sid>
    <match>error: connect_to </match>
    <description>Possible port forwarding failure.</description>
    <group>sshd,</group>
  </rule>

  <!--Sep 23 10:32:25 server sshd[25209]: pam_ldap: error trying to bind as user "uid=user123,ou=People,dc=domain,dc=com" (Invalid credentials)-->
  <rule id="370022" level="2">
    <if_sid>5700</if_sid>
    <!--<match>pam_ldap: error trying to bind as user</match>-->
    <match>Invalid credentials</match>
    <description>User entered incorrect password.</description>
    <group>sshd,ldap,pam,authentication_failures,</group>
  </rule>

  <!--Sep 18 14:58:47 ix sshd[11816]: error: Could not load host key: /etc/ssh/ssh_host_ecdsa_key-->
  <rule id="370023" level="1">
    <if_sid>5700</if_sid>
    <match>Could not load host key</match>
    <description>sshd could not load one or more host keys.</description>
    <info>https://code.google.com/p/wip-ossec-rules/wiki/rule_id_370023</info>
    <group>sshd,sysadmin,</group>
  </rule>

  <!--Sep  4 23:58:33 junction sshd[9351]: fatal: Write failed: Broken pipe-->
  <rule id="370024" level="2">
    <if_sid>5700</if_sid>
    <match>Write failed: Broken pipe</match>
    <description>Failed write due to one host disappearing.</description>
    <group>sshd,</group>
  </rule>

   
</group> <!-- SYSLOG,LOCAL -->


<!-- EOF -->
